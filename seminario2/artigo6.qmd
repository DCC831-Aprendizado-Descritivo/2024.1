---
title: 'Discovering a Taste for the Unusual: Exceptionla Models for Preference Mining'
page-layout: full
---

Minera√ß√£o de modelos excepcionais (Exceptional Model Mining - EMM) √© um framework que tem como objetivo encontrar padr√µes locais, assim como a descoberta de subgrupos (Sbugroup Discovery - SD), por√©m EMM busca encontrar correla√ß√µes entre vari√°veis alvo que podem ser consideradas interessantes/exepcionais. J√° SD busca encontrar padr√µes, criando seletores nos atributos dispon√≠veis, para encontrar individuos que atendam um padr√£o de qualidade em rela√ß√£o a distribui√ß√£o de uma √∫nica vari√°vel alvo.

O artigo aborda uma t√©cnica chamada minera√ß√£o de prefer√™ncias exepcionais (Excepional Preference Mining - EPM), onde procura-se achar prefer√™ncia sobre r√≥tulos, ou seja, encontrar prefer√™ncias excepcionais de diversas op√ß√µes poss√≠veis sobre uma vari√°vel.

## Contextualiza√ß√£o do problema

Diversas linhas de pesquisa buscam construir modelos preditivos capazes de realizarem um ajuste global a um conjunto de dados, de forma fornecer resultados generalizados para todo o conjunto de dados que foi treinado, al√©m de prever com acur√°cia novos conjuntos de dados. Esses modelos podem fornecer grande ajuda em tomadas de decis√£o, pois s√£o capazes de preverem uma vari√°vel alvo. Contudo, pode-se extrair informa√ß√µes valiosas procurando padr√µes locais. Em casos como: elei√ß√µes, market-places, restaurantes, sistemas de recomenda√ß√£o em redes sociais. O objetivo √© tentar encontrar padr√µes de prefer√™ncia, onde seria poss√≠vel encontrar atributos de amostras que caracterizam essas prefer√™ncias. 

Busca-se portanto encontrar correla√ß√µes entre os r√≥tulos, objetivando encontrar uma prefer√™ncia entre eles em grupos locais, considerados excepcionais.

<figure align="center">
    <img src="imgs/artigo6/image1.png" style="max-width: 100%;">
    <figcaption>Descoberta de Modelos Excepcionais</figcaption>
</figure>

Entre os m√©todos que realizam fun√ß√µes semelhantes a EPM, pode-se destacar o uso de regras de associa√ß√£o, proposto por Henzgen e Hullermeier, que faz uma busca por padr√µes de subranking.

## Conceitos importantes

### Label Ranking

Dada uma inst√¢ncia a $x = \{a_1, a_2, \ldots, a_m, \pi\}$ do espa√ßo de inst√¢ncias $\mathbb{X}$, o objetivo √© prever o rank dos r√≥tulos $\mathbb{L} = \{\lambda_1, \ldots, \lambda_n\}$ associados com $x$. O ranking pode ser representado como uma **strict total order** sob $\mathbb{L}$, definido no espa√ßo de permuta√ß√£o $\Omega$.

O Label Ranking se assemelha √†s tarefas de classifica√ß√£o, mas ao inv√©s de prever uma classe, deseja-se ranquear os r√≥tulos. Na classifica√ß√£o, cada inst√¢ncia √© associada a uma **distribui√ß√£o probabil√≠stica** sob $\Omega$. Isso significa que, para cada $x \in \mathbb{X}$, existe uma distribui√ß√£o de probabilidade $\mathbb{P}(.|x)$, de forma que para cada $\pi \in \Omega$, $\mathbb{P}(\pi|x)$ √© a probabilidade de que $\pi$ est√° associado ao ranking de $x$. O objetivo de Label Ranking √© mapear $\mathbb{X} \rightarrow \Omega$.

### Descoberta de Subgrupos e Exceptional Model Mining

A linguagem usada para retornar um subgrupo √© a seguinte:

$ùê¥ùëîùëí ‚â• 30 ‚ãÄ ùêøùëñùëòùëíùë† = ùëÜùëéùëôùëöùëúùëõ ùëÖùëúùëí ‚Üí ùëàùëõùë¢ùë†ùë¢ùëéùëô$

#### M√©trica de Qualidade

Na minera√ß√£o de padr√µes, o qu√£o interessante um padr√£o pode ser √© medido pela sua frequ√™ncia; j√° em Subgroup Discovery (SD) essa m√©trica √© estimada de forma supervisionada. Dada uma vari√°vel alvo $t_1$ identificada no dataset, o qu√£o interessante um subgrupo nela for, √© medido pelo qu√£o n√£o-usual a distribui√ß√£o dele neste alvo.

Se em uma popula√ß√£o o comum √© as pessoas gostarem de sushi **chutoro**, um subgrupo interessante seria de pessoas que gostam de **Makizushi**:

$Age ‚â• 30 ‚ãÄ Lives in Region = Hokkaido ‚Üí Makizushi$


Se ao inv√©s de usar um √∫nico atributo alvo, m√∫ltiplos alvos $t_1, \ldots, t_l$ est√£o dispon√≠veis, e se n√£o estiver interessado em descobrir distribui√ß√µes n√£o usuais em um alvo, mas na intera√ß√£o entre alvos, pode-se ent√£o empregar o **Exceptional Model Mining (EMM)** no lugar do SD. Essa tarefa consiste em dois fatores: **Model Class** e **M√©trica de Qualidade**.

Model Class √© definido para representar uma intera√ß√£o n√£o comum entre m√∫ltiplos alvos que se esteja interessado. J√° a m√©trica de qualidade √© usada para definir o que n√£o √© usual e, portanto, interessante.

Um exemplo seria tentar encontrar uma correla√ß√£o entre a altura de uma pessoa $( t_1 )$ e a altura m√©dia dos av√≥s $( t_2 )$. Para isso, √© necess√°rio achar um coeficiente de correla√ß√£o entre $t_1 $ e $t_2$. Nesse caso aplica-se EMM com um **correlation model class**. No caso de subgrupos muito pequenos, o modelo pode acabar favorecendo-os por serem pouco usuais. Para favorecer subgrupos maiores, deve-se definir uma m√©trica de qualidade que balanceie o qu√£o excepcional um subgrupo √©, e o tamanho dele.

### Estrat√©gia de Busca

Em EMM √© explorado um amplo espa√ßo de busca, guiado por uma m√©trica de qualidade para expressar a excepcionalidade buscada. Tipicamente, os subgrupos s√£o buscados em uma busca por n√≠vel, combinando atributos da mesma forma que √© feita uma combina√ß√£o de itemsets para minera√ß√£o de padr√µes frequentes.

A maioria dos algoritmos de busca, fazem de forma generalista-para-espec√≠fico, tratando o espa√ßo de busca como um **lattice** cuja estrutura √© definida por um **refinement operator** $\eta: \mathbb{D} \rightarrow 2^\mathbb{D}$. Esse operador consegue determinar como descri√ß√µes podem ser estendidas para descri√ß√µes mais complexas por adi√ß√µes at√¥micas. A aplica√ß√£o proposta no artigo assume que $\eta$ √© um **specialization operator**: toda descri√ß√£o $q \in \mathbb{D} $ √© um elemento do conjunto $\eta(p)$, o qual √© mais especializada que a descri√ß√£o $p$ em si. O algoritmo, portanto, retorna uma lista ranqueada de descri√ß√µes que satisfazem as especifica√ß√µes do usu√°rio.

A estrat√©gia de busca empregada foi um **best first search**, em cada n√≠vel as descri√ß√µes s√£o ordenadas pela m√©trica de qualidade $\varphi$. O limite superior √© o grau de complexidade, geralmente limitado por especialistas, para obter descri√ß√µes com quantidades ideais de atributos para interpreta√ß√£o (profundidade da busca); e o limite inferior √© o suporte dos subgrupos.

### Regras de Distribui√ß√µes

Regras de Distribui√ß√µes (Distribution Rules, DR) √© um m√©todo de SD para analisar uma √∫nica vari√°vel alvo. Ao inv√©s de valores representativos (m√©dia, desvio-padr√£o etc.), DR identifica distribui√ß√µes usuais do alvo, encontrando subgrupos expressados pelas regras de associa√ß√£o com a distribui√ß√£o consequente:

$S ‚Üí t = Dist_t|S$

- $S$: √© um conjunto de condi√ß√µes correspondentes √† parte antecedente do DR (um subgrupo).
- $t$: √© a propriedade de interesse (ou o alvo).
- $Dist_t|S$: √© uma distribui√ß√£o emp√≠rica de $t$ quando $S$ √© observado. Ela √© representada por um conjunto de pares $\langle t_i, freq(t_i) \rangle $, onde $t_i$ √© um valor particular de $t$ encontrado quando $S$ √© observado; $freq(t_i)$ √© a frequ√™ncia de $t_i$ quando os itens de $S$ s√£o observados.

## Matriz de Prefer√™ncia
Em EMP o conceito alvo consiste em um √∫nico alvo, o que faz sentido em SD. Contudo, o objeto alvo √© um ranqueamento de r√≥tulos, que pode ser representando como compara√ß√µes em pares. Portanto, representa intera√ß√µes entre m√∫ltiplos r√≥tulos individuais, o que √© mais consistente no cen√°rio do EMM.

Ranqueamento de r√≥tulos pode ser dif√≠cil de analisar e visualizar, quando h√° uma quantidade grande de r√≥tulos. O apresentado Sushi dataset, que cont√©m 5000 amostras de opini√µes de pessoas e 10 tipos de sushi mostra um exemplo real. At√© essa quantidade modesta de tipos de sushi diferentes pode ser ranqueado em diversas combina√ß√µes. Isso pode ter um impacto significativo, onde mais de 98% dos 5000 rankings presentes no dataset s√£o √∫nicos.

Por conta disso, os autores apresentaram uma alternativa para ranquear os r√≥tulos, introduzindo as Matrizes de Prefer√™ncia. A matriz de prefer√™ncia (PM, preference matrix) √© uma representa√ß√£o alternativa dos rankings em um conjunto de dados que facilita a an√°lise de comportamentos de prefer√™ncia excepcionais. Em vez de representar diretamente a ordena√ß√£o dos r√≥tulos, a matriz de prefer√™ncia captura as compara√ß√µes par a par entre r√≥tulos, permitindo uma vis√£o mais detalhada das rela√ß√µes de prefer√™ncia.

Representar um conjunto de rankings por PM tem certas vantagens sob as tradicionais representa√ß√µes por permuta√ß√µes. PM podem, naturalmente, derivar uma variedade de conjunto m√©tricas para busca de padr√µes de prefer√™ncia. Contudo, h√° certas limita√ß√µes tamb√©m, a escolha de agrega√ß√£o de m√©tricas pode esconder informa√ß√µes relevantes nas PMs, por exemplo, escolhendo a m√©dia se metade dos rankings minerados forem opostos, o resultando em entradas na PM s√£o iguais a zero. Por isso subgrupos com PM contendo apenas zeros nas entradas s√£o ignorados.

## Entendendo os algoritmos usados
O algoritmo **EPM** (Exceptional Preference Mining) tem como objetivo identificar subgrupos significativos em um dataset, utilizando uma medida de qualidade para avaliar a diferen√ßa entre as prefer√™ncias do subgrupo e do dataset original.

```python
function EPM(dataset, quality_measure):
    dataset_pm = compute_preference_matrix(dataset)
    candidate_subgroups = generate_candidate_subgroups(dataset)

    for subgroup in candidate_subgroups:
        subgroup_pm = compute_preference_matrix(subgroup)
        distance = calculate_distance(dataset_pm, subgroup_pm, quality_measure)
        subgroup.score = calculate_score(distance, subgroup.size)

    ranked_subgroups = rank_subgroups(dataset_pm, candidate_subgroups)
    significant_subgroups = validate_subgroups(ranked_subgroups)

    return significant_subgroups
```
### Passo a Passo do Algoritmo

Vamos apresentar o algoritmo EPM (Exceptional Preference Mining): 
1. **Fun√ß√£o Principal**

```python
   function EPM(dataset, quality_measure):
```
A fun√ß√£o principal EPM recebe dois par√¢metros:

`dataset`: o conjunto de dados a ser analisado.<br>
`quality_measure`: a medida de qualidade utilizada para avaliar as prefer√™ncias.

2. **Computa√ß√£o da Matriz de Prefer√™ncia do Dataset**

```python
dataset_pm = compute_preference_matrix(dataset)
```
`compute_preference_matrix(dataset)`: Calcula a matriz de prefer√™ncia para o dataset completo, que ser√° utilizada como refer√™ncia para comparar os subgrupos.

1. **Gera√ß√£o de Subgrupos Candidatos**

```python
candidate_subgroups = generate_candidate_subgroups(dataset)
```

`generate_candidate_subgroups(dataset)`: Gera uma lista de subgrupos candidatos a partir do dataset original. Esses subgrupos ser√£o avaliados posteriormente.

1. **Avalia√ß√£o dos Subgrupos Candidatos**
Para cada subgrupo na lista de candidatos, realiza-se os seguintes passos:

```python
for subgroup in candidate_subgroups:
    subgroup_pm = compute_preference_matrix(subgroup)
    distance = calculate_distance(dataset_pm, subgroup_pm, quality_measure)
    subgroup.score = calculate_score(distance, subgroup.size)
```

`compute_preference_matrix(subgroup)`: Calcula a matriz de prefer√™ncia para o subgrupo espec√≠fico.<br>
`calculate_distance(dataset_pm, subgroup_pm, quality_measure)`: Calcula a dist√¢ncia entre a matriz de prefer√™ncia do dataset completo e a do subgrupo, utilizando a medida de qualidade fornecida.

#### F√≥rmula Geral

A dist√¢ncia geral $L_S$ entre a matriz de prefer√™ncia do dataset completo $M_D$ e a matriz de prefer√™ncia do subgrupo $M_S$ √© calculada como:

$L_S = \frac{1}{2} (M_D - M_S)$

#### Medidas de Qualidade

##### Norm

A medida de qualidade `Norm` √© definida como a norma de Frobenius da matriz $L_S$. A f√≥rmula √©:

$\text{Norm}(S) = \| L_S \|_F = \sqrt{s/n} \cdot \sqrt{ \sum_{i=1}^{k} \sum_{j=1}^{k} L(i,j)^2 }$

##### Labelwise

A medida de qualidade `Labelwise` √© calculada como o valor m√°ximo entre todas as somas das linhas da matriz $L_S$:

$\text{Labelwise}(S) = \max_{i=1,\ldots,k} \frac{1}{k(k-1)} \sum_{j=1}^{k} L(i,j)$

##### Pairwise

A medida de qualidade `Pairwise` √© calculada como o valor m√°ximo entre todos os elementos da matriz $L_S$:

$\text{Pairwise}(S) = \max_{i,j=1,\ldots,k} L(i,j)$

Essas medidas s√£o utilizadas para avaliar a diferen√ßa entre as prefer√™ncias do dataset original e dos subgrupos, ajudando a identificar subgrupos excepcionais.

`calculate_score(distance, subgroup.size)`: Calcula a pontua√ß√£o do subgrupo com base na dist√¢ncia calculada e no tamanho do subgrupo.

#### Passos para Calcular a Pontua√ß√£o

   **Calcular a Cobertura Normalizada do Grupo**

   A Cobertura Normalizada do Grupo √© dada por:

   $\sqrt{\frac{s}{n}}$

   onde:
   - $s$ √© o tamanho do subgrupo.
   - $n$ √© o tamanho do dataset completo.

   **Multiplicar pela Dist√¢ncia**

   A pontua√ß√£o final do subgrupo √© obtida multiplicando a Cobertura Normalizada do Grupo pela Dist√¢ncia calculada na fun√ß√£o `calculate_distance`.

1. **Ranqueamento dos Subgrupos**

```python
ranked_subgroups = rank_subgroups(dataset_pm, candidate_subgroups)
```
`rank_subgroups(dataset_pm, candidate_subgroups)`: Ordena os subgrupos candidatos com base na pontua√ß√£o calculada, gerando uma lista de subgrupos ranqueados.

#### F√≥rmula da Covari√¢ncia Ponderada

A f√≥rmula utilizada para calcular a covari√¢ncia ponderada entre o vetor da matriz de prefer√™ncia do dataset completo $\text{vec}(M_D)$ e o vetor da matriz de prefer√™ncia do subgrupo $\text{vec}(M_S)$ √©:

$\text{RWCov}(S) = -\sqrt{\frac{s}{n}} \cdot \text{cov}(\text{vec}(M_D), \text{vec}(M_S))$

onde:<br>
   - $\text{vec}(M_D)$ √© o vetor da matriz de prefer√™ncia do dataset completo.<br>
   - $\text{vec}(M_S)$ √© o vetor da matriz de prefer√™ncia do subgrupo.<br>
   - $\text{cov}$ representa a covari√¢ncia entre os dois vetores.<br>
   - $s$ √© o tamanho do subgrupo.<br>
   - $n$ √© o tamanho do dataset completo.

Esta medida ajuda a identificar subgrupos que possuem prefer√™ncias excepcionalmente diferentes em rela√ß√£o ao dataset original.

1. **Valida√ß√£o dos Subgrupos Significativos**

```python
significant_subgroups = validate_subgroups(ranked_subgroups)
```

`validate_subgroups(ranked_subgroups)`: Valida os subgrupos ranqueados para identificar aqueles que s√£o estatisticamente significativos.

1. **Retorno dos Subgrupos Significativos**
Retorno dos Subgrupos Significativos

```python
return significant_subgroups
```

## Metodologia

Para fazer os experimentos, os autores incorporaram EPM no [Cortana](https://datamining.liacs.nl/cortana.html), que oferece uma estrutura gen√©rica para descoberta de subgrupos e possui ferramentas para que diferentes abordagens de SD sejam aplicadas. Al√©m disso, eles definiram uma linguagem de descri√ß√£o para os subgrupos, que √© composta por conjun√ß√µes l√≥gicas de restri√ß√µes para atributos individuais. 

A estrat√©gia adotada para percorrer o espa√ßo de busca foi uma best-first search gulosa. Sendo que os atributos num√©ricos foram discretizados com *on fly greedy best-first search* contendo 8 bins de mesma largura. Os resultados encontrados passaram pela valida√ß√£o DFD, que serve para evitar que subgrupos sejam selecionados por fatores aleat√≥rios. A valida√ß√£o DFD consiste na cria√ß√£o de c√≥pias do dataset, com algumas altera√ß√µes aleat√≥rias dos atributos-alvo. Subgrupos encontrados nessas c√≥pias podem ser considerados aleat√≥rios. Dessa forma, o m√©todo EPM foi aplicado sobre alguns datasets reais. O procedimento DFD permite controlar o problema das m√∫ltiplas compara√ß√µes em SD e EMM, fornecendo uma forma robusta de identificar padr√µes realmente excepcionais enquanto minimiza a probabilidade de falsas descobertas.

O procedimento DFD tem apenas um par√¢metro: o n√∫mero de c√≥pias do conjunto de dados. Este n√∫mero deve ser suficientemente grande para satisfazer certas condi√ß√µes decorrentes da modelagem global envolvida na cria√ß√£o da DFD. Tipicamente, 100 c√≥pias s√£o suficientes, com um n√≠vel de signific√¢ncia estat√≠stica de 1%.

Seis bases de dados reais de diferentes dom√≠nios foram utilizadas nos experimentos. O dataset Algae apresenta os n√≠veis de frequ√™ncia de alguns tipos de alga em diferentes rios europeus. O dataset Sushi cont√©m os dados demogr√°ficos de um conjunto de pessoas, bem como suas prefer√™ncias em rela√ß√£o a diferentes tipos de sushi. O dataset Top7movies √© um subconjunto de outra base de dados, que apresenta os rankings dos usu√°rios para os 7 filmes mais avaliados. Os datasets GermanElections2005 e GermanElections2009 cont√©m dados socioecon√¥micos dos distritos administrativos da Alemanha e o ranking de vota√ß√£o dos partidos mais populares nessas regi√µes. O dataset Cpu-small apresenta dados extra√≠dos de medi√ß√µes relacionadas a servidores. 

<figure align="center">
    <img src="imgs/artigo6/sushi_movie.png" style="max-width: 100%;">
    <figcaption>Imagem gerada por [DALL-E](https://openai.com/index/dall-e-2/)</figcaption>
</figure>

<figure align="center">
    <img src="imgs/artigo6/databases.png" style="max-width: 100%;">
    <figcaption>Bases de Dados</figcaption>
</figure>

√â usado um m√©todo chamado Regra de Distribui√ß√£o para procurar distribui√ß√µes alvo, ele foi comparado com o RWNorm aplicado no Cortana

<figure align="center">
    <img src="imgs/artigo6/caren.png" style="max-width: 100%;">
    <figcaption>Metodologia t√©cnica DR</figcaption>
</figure>


Para comparar a distribui√ß√£o dos subgrupos com a popul√ß√£o (o conjunto de dados inteiro) foi realizado o teste estat√≠stico de Komolgorov-Smirgov


## Resultados obtidos

A excepcionalidade informada pelas m√©tricas de qualidade podem se apresentar de diferentes formas em diferentes m√©tricas de qualidade, ou seja, depende o que a m√©tricas de qualidade est√° procurando. As m√©tricas podem at√© estar correlacionadas, mas n√£o perfeitamente, os autores forneceram no estudo uma forma do usu√°rio utilizar essas m√©tricas para tomar escolhas mais bem informadas.

<figure align="center">
    <img src="imgs/artigo6/results.png" style="max-width: 100%;">
    <figcaption>Rela√ß√£o Entre M√©tricas de Qualidade</figcaption>
</figure>


A figura acima mostra gera√ß√£o de 10.000 subgrupos aleat√≥rios, os quais a pontua√ß√£o foi avaliada pelas m√©tricas de qualidade apresentadas. A gera√ß√£o aleat√≥ria combina descri√ß√µes at√© uma profundidade m√°xima ser alcan√ßada. A profundidade da busca √© fixada em 3, permitindo uma boa diversidade de combina√ß√µes de atributos. Para cada par de m√©trica de qualidade na figura, h√° um scatter plot mostrando a rela√ß√£o das pontua√ß√µes.
A primeira linha mostra os subgrupos avaliados por RWNorm e o eixo vertical representa a pontua√ß√£o dela; o eixo horizontal representa a pontua√ß√£o de cada m√©trica de qualidade na seguinte ordem: RWNorm; RWNorm-mode; RWCov; LWNorm; PWMax

Pode-se notar que RWNorm-mode mostra um comportamento distinto, ela √© baseada na matriz de dist√¢ncia diferencial L_S, obtida pela diferen√ßa entre as modas da popula√ß√£o (M_D) e a moda dos subgrupos (M_S). Para essa m√©trica, se houver uma invers√£o de prefer√™ncia no ranking dos r√≥tulos em algum subgrupo de tamanho significativo, ele √© considerado interessante, mesmo que seja pouco, como 2%. Para as m√©tricas RWMNorm, LWNorm e PWMax, subgrupos desse tipo j√° n√£o ir√£o ser interessantes, a n√£o ser que a diferen√ßa seja maior, isso fica evidente observando a segunda linha da Figura.

Observando o RWConv, parece que tem o maior vi√©s, isso se d√° pelo fato dessa m√©trica n√£o se basear na matriz de dist√¢ncia L_S; ao inv√©s disso ela √© baseada na correla√ß√£o negativa entre as matrizes de popula√ß√£o (M_D) e subgrupos (M_S). Portanto, essa m√©trica de qualidade n√£o necessariamente ir√° encontrar subgrupos que maximizem a preference distance, mas ir√° mostrar features n√£o usuais de comportamento de forma abstrata.

### 1. Elei√ß√µes Alem√£s (2005 e 2009) GermanElections2005:

- Utilizando a m√©trica de qualidade PWMax com profundidade de busca 1, foram encontrados 62 subgrupos significativos.
- O subgrupo mais relevante foi "Regi√£o = Leste", onde o partido Esquerda teve mais votos que o partido FDP em todos os 87 distritos da Alemanha Oriental, contrastando com a maioria dos distritos na Alemanha.
- Outro subgrupo significativo mostrou que em regi√µes de baixa renda (renda ‚â§ 16.979), o partido Esquerda recebeu mais votos que o partido Verde.
GermanElections2009:

- Com as mesmas configura√ß√µes, foram identificados 57 subgrupos significativos.
Novamente, "Regi√£o = Leste" mostrou uma forte prefer√™ncia pelo partido Esquerda em compara√ß√£o ao partido Verde.
- Houve um aumento no n√∫mero de distritos de baixa renda favorecendo o partido Esquerda em rela√ß√£o ao partido Verde comparado a 2005.
An√°lise com LWNorm:

- Usando a m√©trica LWNorm com profundidade de busca 2, foram encontrados 2965 subgrupos significativos.
- O subgrupo "Regi√£o = Leste" continuou mostrando forte prefer√™ncia pelo partido Esquerda.
- Outros subgrupos com caracter√≠sticas como menor popula√ß√£o infantil e maior desemprego tamb√©m favoreceram o partido Esquerda, enquanto regi√µes de maior renda mostraram o partido Esquerda como o menos votado.

### 2. Top7Movies
- Utilizando a m√©trica LWNorm, foram encontrados 2 subgrupos significativos com profundidade de busca 2.
- O primeiro subgrupo inclu√≠a pessoas com mais de 34 anos vivendo abaixo de uma latitude de 32.9, que n√£o gostaram do filme "Beleza Americana" e preferiram "Star Wars: Epis√≥dio IV" e "O Resgate do Soldado Ryan".
- A m√©dia de classifica√ß√£o deste subgrupo foi b (Star Wars: Epis√≥dio IV) > f (O Resgate do Soldado Ryan) > c (Star Wars: Epis√≥dio V) > d (Star Wars: Epis√≥dio VI) > g (O Exterminador do Futuro 2) > a (Beleza Americana) > e (Jurassic Park).

<figure align="center">
    <img src="imgs/artigo6/results1.png" style="max-width: 100%;">
    <figcaption>Resultados Filmes Matriz de Prefixos</figcaption>
</figure>


### 3. Algae
- Utilizando a m√©trica RWNorm, os resultados indicam que durante a primavera, as esp√©cies de algas a, b e c s√£o mais comuns em rios.
- A m√©trica LWNorm revelou mais de 400 subgrupos com profundidade m√°xima de 2.
- O melhor subgrupo mostrou que a esp√©cie de alga a √© fortemente preferida no subgrupo em compara√ß√£o com o conjunto de dados geral.
- Utilizando profundidade de 3, foram encontrados cerca de 5400 subgrupos, mostrando um comportamento oposto em rela√ß√£o √† esp√©cie de alga a.

### 4. Sushi
- Devido ao alto percentual de rankings √∫nicos, focou-se em padr√µes de ranking labelwise.
- A m√©trica LWNorm identificou 149 subgrupos.
- O melhor subgrupo revelou que homens com mais de 30 anos mostraram uma forte prefer√™ncia por ouri√ßo-do-mar (r√≥tulo e), contrastando com a popula√ß√£o geral.

<figure align="center">
    <img src="imgs/artigo6/results2.png" style="max-width: 100%;">
    <figcaption>Compara√ß√£o de Subgrupod de Prefer√™ncia de Sushi com a Popula√ß√£o</figcaption>
</figure>


### 5. Cpu-small
- Utilizando a m√©trica RWCov, foram encontrados 275 subgrupos significativos com profundidade m√°xima de 4.
- O subgrupo mais relevante exibiu grandes desvios em todas as entradas da matriz de prefer√™ncia, indicando comportamento de prefer√™ncia incomum.

### 6. Compara√ß√£o de M√©tricas de Qualidade
- Observou-se uma varia√ß√£o na quantidade de subgrupos obtidos por diferentes m√©tricas.

- A RWNorm apresentou mais subgrupos em compara√ß√£o a RWNorm-Mode e RWCov.
Cada m√©trica mostrou diferentes vieses, destacando subgrupos espec√≠ficos com comportamentos de prefer√™ncia √∫nicos.

- Esses resultados demonstram a efic√°cia do EPM na identifica√ß√£o de padr√µes de prefer√™ncia excepcionais em diversos contextos, proporcionando insights valiosos sobre comportamentos n√£o usuais em rankings.

Tamb√©m foi feita uma compara√ß√£o entre o CORTANA e o CAREN que usava a t√©cnica DR:
<figure align="center">
    <img src="imgs/artigo6/caren_cortana_results.png" style="max-width: 100%;">
    <figcaption>Compara√ß√£o Resultados CAREN vs CORTANA</figcaption>
</figure>


## Aplica√ß√µes e desafios

A minera√ß√£o de prefer√™ncias excepcionais pode ser aplicada em diversos contextos e trazer benef√≠cios. Vamos apresentar abaixo algumas aplica√ß√µes onde o uso de EPM teria grande valor. 

Na √°rea de neg√≥cios, seria poss√≠vel encontrar subpopula√ß√µes que possuem prefer√™ncias divergentes da maioria, o que permitiria a constru√ß√£o de estrat√©gias de marketing direcionado a esses nichos. Al√©m disso, torna-se mais f√°cil a identifica√ß√£o de varia√ß√µes em tend√™ncias de mercado. 

A medicina pode ser positivamente afetada pelo uso de EPM na segmenta√ß√£o de grupos de pacientes com caracter√≠sticas semelhantes. Isso faz com que cada grupo possa receber um tratamento mais especializado. 

Outro exemplo de aplica√ß√£o √© o setor p√∫blico. Nesse caso, o conceito de prefer√™ncia poderia ser usado de forma an√°loga para identificar subgrupos que possuem necessidades espec√≠ficas, possibilitando a cria√ß√£o de pol√≠ticas p√∫blicas direcionadas para atender essas pessoas. 

Na √°rea de gest√£o de recursos humanos, seria interessante utilizar EPM para detectar nichos de funcion√°rios que possuem alguns fatores de motiva√ß√£o e necessidades mais espec√≠ficos. Assim, a equipe de RH poderia agir de maneira mais assertiva, tornando o ambiente de trabalho mais agrad√°vel e inclusivo. 

Apesar das possibilidades ben√©ficas citadas acima, √© importante ressaltar os impactos negativos que podem surgir com a aplica√ß√£o da t√©cnica de EPM nesses cen√°rios. O principal impacto identificado √© a manipula√ß√£o de informa√ß√µes. A busca por padr√µes de prefer√™ncias que fogem √† regra geral pode ser usada de forma indevida caso esses padr√µes sejam divulgados como se fossem representativos para toda a popula√ß√£o. Como um exemplo, pode-se pensar no caso em que uma empresa usa as informa√ß√µes de grupos espec√≠ficos para promover seus produtos para o p√∫blico geral, o que configura em uma propaganda enganosa. 

## Execu√ß√£o dos algoritmos usados no artigo

O c√≥digo-fonte desenvolvido pelos autores para elabora√ß√£o do artigo n√£o foi disponibilizado. No entanto, foram encontrados dois reposit√≥rios no GitHub que utilizam as mesmas t√©cnicas e citam o artigo estudado.
 
### Reposit√≥rio MD2S_MusicProject 

Este reposit√≥rio n√£o foi muito explorado pela equipe respons√°vel, pois a documenta√ß√£o que explica os detalhes de implementa√ß√£o foi escrita em franc√™s, o que dificultou o entendimento.

[Link para o reposit√≥rio](https://github.com/alicemontel/M2DS_MusicProject/tree/master)
 
### Reposit√≥rio My-Sushi-Addiction 

A implementa√ß√£o contida nesse reposit√≥rio aplica a EPM em um dataset de prefer√™ncias de tipos de sushi, mas permite tamb√©m que outros datasets possam ser utilizados. Diferentemente do artigo, o algoritmo de busca usado nessa vers√£o de EPM foi o beam search. No reposit√≥rio, a m√©trica de qualidade √© parametriz√°vel, mas apenas a RWNorm est√° dispon√≠vel para experimenta√ß√£o. Para utilizar outras m√©tricas, √© necess√°rio implement√°-las antes de passar como par√¢metro. 

<figure align="center">
    <img src="imgs/artigo6/sushi_db.png" style="max-width: 100%;">
    <figcaption>Base de dados Sushi 2016</figcaption>
</figure>


[Link para o reposit√≥rio](https://github.com/CharlesGaydon/My-Sushi-Addiction)

- **0 Quick_Start.ipynb**: Realiza a execu√ß√£o do projeto em passos simples, bastando apenas seguir o roteiro do pr√≥prio notebook. √â poss√≠vel at√© aplicar a EPM aos pr√≥prios dados do usu√°rio, n√£o apenas ao dataset do sushi; ‚Äã

- **1 Exceptional_Preference_Mining.ipynb**: Estruturado como um rascunho, este notebook mostra, passo a passo, como foi implementado o algoritmo de Beam Search e sua aplica√ß√£o ao conjunto de dados de sushi;‚Äã

- **beam_search.py**: Fun√ß√µes para o algoritmo de Beam Search;‚Äã

- **preference_matrix.py**: Fun√ß√µes para calcular e visualizar a Matriz de Prefer√™ncia, e calcular uma pontua√ß√£o de excepcionalidade derivada delas.

O grupo respons√°vel realizou testes, aplicando o EPM sobre o dataset disponibilizado no reposit√≥rio. Os principais subgrupos excepcionais descobertos foram os subgrupos de mulheres com menos de 19 anos e homens que responderam a pesquisa muito rapidamente. Tamb√©m foram feitos experimentos com as outras m√©tricas que n√£o haviam sido previamente disponibilizadas. No geral, os resultados foram semelhantes √†queles vistos com a RWNorm. Uma descoberta not√°vel foi o subgrupo de mulheres com menos de 39 anos de idade com a m√©trica LWNorm.

<figure align="center">
    <img src="imgs/artigo6/results_hacker.png" style="max-width: 100%;">
    <figcaption>Resultados Hacker</figcaption>
</figure>

## Conclus√£o

O artigo analisado apresenta a t√©cnica de Exceptional Preferences Mining (EPM) como uma abordagem inovadora para a descoberta de subgrupos com padr√µes de prefer√™ncia excepcionais. Atrav√©s de uma compara√ß√£o detalhada com outras t√©cnicas, como SD e EMM, o artigo evidencia a especificidade e a utilidade da EPM. Os experimentos realizados com diversos conjuntos de dados demonstram a efic√°cia da t√©cnica e suas poss√≠veis aplica√ß√µes em √°reas como neg√≥cios, medicina, setor p√∫blico e gest√£o de recursos humanos. Apesar dos benef√≠cios apresentados, √© importante considerar os impactos negativos potenciais, como a manipula√ß√£o de informa√ß√µes. A an√°lise dos reposit√≥rios relacionados tamb√©m fornece informa√ß√µes importantes sobre a implementa√ß√£o pr√°tica da EPM, evidenciando a adaptabilidade e flexibilidade da t√©cnica. 

## Refer√™ncias

de S√°, C. R., Duivesteijn, W., Azevedo, P., Jorge, A. M., Soares, C., & Knobbe, A. (2018). Discovering a taste for the unusual: exceptional models for preference mining. Machine Learning, 107, 1775-1807. 